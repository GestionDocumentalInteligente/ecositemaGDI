// i18n.js - Internationalization
const i18n = {
  currentLang: 'es',

  translations: {
    es: {
      nav: {
        solutions: 'Soluciones',
        protocol: 'Protocolo',
        fundamentals: 'Fundamentals',
        contact: 'Contacto'
      },
      hero: {
        badge: 'Ecosistema GDI',
        title: 'El sistema no se reforma. Se HACKEA.',
        subtitle: '"El secreto del cambio es enfocar toda tu energ√≠a, no en luchar contra lo viejo, sino en construir lo nuevo."',
        subtitleAuthor: 'S√≥crates'
      },
      protocol: {
        user: 'USUARIO',
        applications: 'APLICACIONES',
        validation: 'VALIDACI√ìN',
        protocol: 'PROTOCOLO',
        operation: 'OPERACI√ìN'
      },
      home: {
        featuredSolutions: 'Soluciones',
        viewAll: 'Ver todas las soluciones ‚Üí'
      },
      solutions: {
        pageTitle: 'Soluciones que construyen el futuro de las ciudades, ignorando las reglas del pasado'
      },
      filters: {
        all: 'Todas'
      },
      categories: {
        government: 'Gobierno',
        identity: 'Identidad',
        fintech: 'Fintech',
        health: 'Salud',
        city: 'Ciudad',
        mobility: 'Movilidad'
      },
      loading: 'Cargando soluciones...',
      emptyState: 'No se encontraron soluciones',
      cities: {
        title: 'Todas las ciudades <u>tienen</u> los mismos problemas',
        text1: 'Estamos construyendo un nuevo est√°ndar de colaboraci√≥n p√∫blico-privada.',
        text2: 'Un ecosistema API-first para integrar nuevas soluciones a los problemas que tenemos por vivir en comunidad.',
        text3: 'Completa el form y conect√° tu soluci√≥n a cientos de ciudades.',
        cta: 'Conoc√© m√°s en Protocolo ‚Üí'
      },
      modal: {
        website: 'Visitar sitio web',
        email: 'Enviar email',
        phone: 'Llamar',
        founders: 'Founders'
      },
      contact: {
        title: 'Suma tu soluci√≥n!',
        subtitle: 'Completa el formulario',
        formPlaceholder: 'Formulario de Contacto',
        formInstructions: 'Aqu√≠ se incrustar√° el Google Form. Para agregar el formulario, edita el archivo contact.html y pega el c√≥digo iframe de Google Forms.'
      },
      footer: {
        tagline: 'Transformando ciudades con tecnolog√≠a',
        quickLinks: 'Links',
        home: 'Inicio',
        solutions: 'Soluciones',
        protocol: 'Protocolo',
        fundamentals: 'Fundamentals',
        contact: 'Contacto'
      },
      card: {
        viewMore: 'Ver m√°s'
      },
      protocolPage: {
        hero: {
          title: 'El Protocolo',
          text1: 'Los procesos obsoletos no se arreglan. Se reemplazan.',
          text2: 'Ecosistema GDI es un protocolo que permite la interoperabilidad descentralizada donde cada soluci√≥n es un nodo que resuelve un problema que tenemos por vivir en comunidad.',
          cta: 'No pidas permiso. Constru√≠.'
        },
        learnFundamentals: 'Conoc√© los Fundamentals ‚Üí',
        principles: {
          title: 'Principios del Ecosistema',
          principle1: {
            title: 'Descentralizaci√≥n',
            text: 'No dependemos de una autoridad central. Cada soluci√≥n es aut√≥noma pero interoperable.'
          },
          principle2: {
            title: 'Acci√≥n sobre Permiso',
            text: 'No esperamos aprobaci√≥n. Construimos primero, pedimos perd√≥n despu√©s (si es necesario).'
          },
          principle3: {
            title: 'Pragmatismo',
            text: 'Lo que funciona es m√°s importante que lo que es "correcto" seg√∫n reglas obsoletas.'
          },
          principle4: {
            title: 'Comunidad',
            text: 'Resolvemos problemas que tenemos por vivir en comunidad, para la comunidad.'
          }
        }
      },
      fundamentalsPage: {
        title: 'Una gu√≠a para construir infraestructura paralela',
        learnMore: 'Libro C√ìMO HACKEAR EL SISTEMA',
        intro: {
          title: 'El Problema',
          text1: 'Los sistemas actuales fueron dise√±ados para un mundo a papel. Burocracia, procesos obsoletos y decisiones por intuici√≥n.',
          text2: 'La respuesta tradicional nos tiene encerrados en un laberinto sin salida.'
        },
        solution: {
          title: 'La Soluci√≥n',
          text1: 'No pidas permiso. Constru√≠.',
          text2: 'En lugar de esperar que las instituciones cambien, construimos una infraestructura paralela. Soluciones que funcionan hoy, para ciudades que quieran liderar.',
          text3: 'Cada soluci√≥n del Ecosistema GDI es un nodo que resuelve un problema real.',
          text4: 'Sin intermediarios. Sin burocracia.'
        },
        howItWorks: {
          title: 'C√≥mo Funciona',
          step1: {
            title: 'Identificar el Problema',
            text: 'Encontr√° un proceso obsoleto, una fricci√≥n innecesaria, un problema que el sistema tradicional no puede o no quiere resolver.'
          },
          step2: {
            title: 'Construir la Soluci√≥n',
            text: 'Dise√±√° una soluci√≥n m√≠nima viable. No esper√©s permiso. No esper√©s que sea perfecta. Hacela funcionar.'
          },
          step3: {
            title: 'Conectar con el Ecosistema',
            text: 'Tu soluci√≥n se integra con otras del ecosistema. Interoperabilidad descentralizada. Cada nodo se fortalece con los dem√°s.'
          },
          step4: {
            title: 'Escalar',
            text: 'Cuando miles de personas usan tu soluci√≥n, el sistema tradicional se vuelve irrelevante. No lo combatiste. Lo reemplazaste.'
          }
        },
        principles: {
          title: 'Principios del Ecosistema',
          principle1: {
            title: 'Descentralizaci√≥n',
            text: 'No dependemos de una autoridad central. Cada soluci√≥n es aut√≥noma pero interoperable.'
          },
          principle2: {
            title: 'Acci√≥n sobre Permiso',
            text: 'No esperamos aprobaci√≥n. Construimos primero, pedimos perd√≥n despu√©s (si es necesario).'
          },
          principle3: {
            title: 'Pragmatismo',
            text: 'Lo que funciona es m√°s importante que lo que es "correcto" seg√∫n reglas obsoletas.'
          },
          principle4: {
            title: 'Comunidad',
            text: 'Resolvemos problemas que tenemos por vivir en comunidad, para la comunidad.'
          }
        },
        cta: {
          title: 'Unite al Ecosistema',
          text: 'Si ten√©s una soluci√≥n que resuelve un problema real, sumala al ecosistema!',
          uploadSolution: 'Cargar Soluci√≥n'
        }
      }
    },
    en: {
      nav: {
        solutions: 'Solutions',
        protocol: 'Protocol',
        fundamentals: 'Fundamentals',
        contact: 'Contact'
      },
      hero: {
        badge: 'GDI Ecosystem',
        title: 'The system doesn\'t get reformed. It gets HACKED.',
        subtitle: '"The secret of change is to focus all your energy not on fighting the old, but on building the new."',
        subtitleAuthor: 'Socrates'
      },
      protocol: {
        user: 'USER',
        applications: 'APPLICATIONS',
        validation: 'VALIDATION',
        protocol: 'PROTOCOL',
        operation: 'OPERATION'
      },
      home: {
        featuredSolutions: 'Solutions',
        viewAll: 'View all solutions ‚Üí'
      },
      solutions: {
        pageTitle: 'Solutions building the future of cities, ignoring the rules of the past'
      },
      filters: {
        all: 'All'
      },
      categories: {
        government: 'Government',
        identity: 'Identity',
        fintech: 'Fintech',
        health: 'Health',
        city: 'City',
        mobility: 'Mobility'
      },
      loading: 'Loading solutions...',
      emptyState: 'No solutions found',
      cities: {
        title: 'All cities <u>have</u> the same problems',
        text1: 'We are building a new standard for public-private collaboration.',
        text2: 'An API-first ecosystem to integrate new solutions to the problems we have from living in community.',
        text3: 'Complete the form and connect your solution to hundreds of cities.',
        cta: 'Learn more about the Protocol ‚Üí'
      },
      modal: {
        website: 'Visit website',
        email: 'Send email',
        phone: 'Call',
        founders: 'Founders'
      },
      contact: {
        title: 'Add your solution!',
        subtitle: 'Fill out the form',
        formPlaceholder: 'Contact Form',
        formInstructions: 'The Google Form will be embedded here. To add the form, edit the contact.html file and paste the Google Forms iframe code.'
      },
      footer: {
        tagline: 'Transforming cities with technology',
        quickLinks: 'Links',
        home: 'Home',
        solutions: 'Solutions',
        protocol: 'Protocol',
        fundamentals: 'Fundamentals',
        contact: 'Contact'
      },
      card: {
        viewMore: 'View more'
      },
      protocolPage: {
        hero: {
          title: 'The Protocol',
          text1: 'Obsolete processes don\'t get fixed. They get replaced.',
          text2: 'GDI Ecosystem is a decentralized interoperability protocol where each solution is a node that solves a problem we have from living in community.',
          cta: 'Don\'t ask for permission. Build.'
        },
        learnFundamentals: 'Learn the Fundamentals ‚Üí',
        principles: {
          title: 'Ecosystem Principles',
          principle1: {
            title: 'Decentralization',
            text: 'We don\'t depend on a central authority. Each solution is autonomous but interoperable.'
          },
          principle2: {
            title: 'Action over Permission',
            text: 'We don\'t wait for approval. We build first, ask for forgiveness later (if necessary).'
          },
          principle3: {
            title: 'Pragmatism',
            text: 'What works is more important than what is "correct" according to obsolete rules.'
          },
          principle4: {
            title: 'Community',
            text: 'We solve problems we have from living in community, for the community.'
          }
        }
      },
      fundamentalsPage: {
        title: 'A guide to building parallel infrastructure',
        learnMore: 'Book HOW TO HACK THE SYSTEM',
        intro: {
          title: 'The Problem',
          text1: 'Current systems were designed for a paper world. Bureaucracy, obsolete processes, and decisions by intuition.',
          text2: 'The traditional response has us trapped in a maze with no way out.'
        },
        solution: {
          title: 'The Solution',
          text1: 'Don\'t ask for permission. Build.',
          text2: 'Instead of waiting for institutions to change, we build parallel infrastructure. Solutions that work today, for cities that want to lead.',
          text3: 'Each solution in the GDI Ecosystem is a node that solves a real problem.',
          text4: 'No intermediaries. No bureaucracy.'
        },
        howItWorks: {
          title: 'How It Works',
          step1: {
            title: 'Identify the Problem',
            text: 'Find an obsolete process, an unnecessary friction, a problem that the traditional system cannot or will not solve.'
          },
          step2: {
            title: 'Build the Solution',
            text: 'Design a minimum viable solution. Don\'t wait for permission. Don\'t wait for it to be perfect. Make it work.'
          },
          step3: {
            title: 'Connect with the Ecosystem',
            text: 'Your solution integrates with others in the ecosystem. Decentralized interoperability. Each node strengthens the others.'
          },
          step4: {
            title: 'Scale',
            text: 'When thousands of people use your solution, the traditional system becomes irrelevant. You didn\'t fight it. You replaced it.'
          }
        },
        principles: {
          title: 'Ecosystem Principles',
          principle1: {
            title: 'Decentralization',
            text: 'We don\'t depend on a central authority. Each solution is autonomous but interoperable.'
          },
          principle2: {
            title: 'Action over Permission',
            text: 'We don\'t wait for approval. We build first, ask for forgiveness later (if necessary).'
          },
          principle3: {
            title: 'Pragmatism',
            text: 'What works is more important than what is "correct" according to obsolete rules.'
          },
          principle4: {
            title: 'Community',
            text: 'We solve problems we have from living in community, for the community.'
          }
        },
        cta: {
          title: 'Join the Ecosystem',
          text: 'If you have a solution that solves a real problem, add it to the ecosystem!',
          uploadSolution: 'Upload Solution'
        }
      }
    }
  },

  // Initialize i18n
  init() {
    // Load language from localStorage or default to 'es'
    const savedLang = localStorage.getItem('lang') || 'es';
    this.setLanguage(savedLang);

    // Setup language toggle
    const langToggle = document.getElementById('lang-toggle');
    if (langToggle) {
      langToggle.addEventListener('click', () => {
        const newLang = this.currentLang === 'es' ? 'en' : 'es';
        this.setLanguage(newLang);
      });
    }
  },

  // Set language
  setLanguage(lang) {
    this.currentLang = lang;
    localStorage.setItem('lang', lang);

    // Update current lang display
    const currentLangEl = document.getElementById('current-lang');
    if (currentLangEl) {
      currentLangEl.textContent = lang.toUpperCase();
    }

    // Update all i18n elements
    this.updateElements();

    // Dispatch event for other components to react
    document.dispatchEvent(new CustomEvent('languageChanged', { detail: { lang } }));
  },

  // Update all elements with data-i18n attribute
  updateElements() {
    const elements = document.querySelectorAll('[data-i18n]');

    elements.forEach(el => {
      const key = el.getAttribute('data-i18n');
      const translation = this.get(key);

      if (translation) {
        el.innerHTML = translation;
      }
    });
  },

  // Get translation by key (supports nested keys like 'hero.title')
  get(key) {
    const keys = key.split('.');
    let value = this.translations[this.currentLang];

    for (const k of keys) {
      if (value && typeof value === 'object') {
        value = value[k];
      } else {
        return key; // Return key if not found
      }
    }

    return value || key;
  },

  // Get category name
  getCategoryName(category) {
    const categoryMap = {
      'mobility': 'categories.mobility',
      'public-space': 'categories.publicSpace',
      'fintech': 'categories.fintech',
      'legal-ai': 'categories.legalAI',
      'data': 'categories.data'
    };

    return this.get(categoryMap[category] || category);
  },

  // Get category emoji
  getCategoryEmoji(category) {
    const emojiMap = {
      'mobility': 'üöó',
      'public-space': 'üèõÔ∏è',
      'fintech': 'üí∞',
      'legal-ai': '‚öñÔ∏è',
      'data': 'üìä'
    };

    return emojiMap[category] || '';
  }
};

// Auto-initialize when DOM is ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', () => i18n.init());
} else {
  i18n.init();
}
